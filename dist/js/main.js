(()=>{"use strict";(()=>{class e extends Person{constructor(e,t,r,a,l,o){super(e,t,r,a),this.postJob=l,this.position=o}static workerArr=JSON.parse(localStorage.getItem("workers"))||[];static removeWorker(t){e.workerArr.splice(e.workerArr.indexOf(t),1)}addWorker(t){e.workerArr.push(t)}}})(),(()=>{const e=document.querySelector("input[id=name]"),t=document.querySelector("input[id=surname]"),r=document.querySelector("input[id=age]"),a=document.querySelectorAll("input[name=gender]"),l=document.querySelector("input[id=male]"),o=document.querySelector("input[id=female]"),s=document.querySelector("select[id=postjob]"),n=document.querySelector("select[id=position]"),c=document.querySelectorAll("input[name=employment]"),i=document.querySelector("input[id=ft]"),d=document.querySelector("input[id=pt]"),u=(document.querySelectorAll(".form__label-error"),document.querySelector(".form__elements")),m=document.querySelector(".table__elements"),g=document.getElementById("workers-count"),y=document.getElementById("salary-count"),S=document.getElementById("overlay"),p=document.getElementById("popup"),k=document.getElementById("close");let v=JSON.parse(localStorage.getItem("gender"))||"",b=JSON.parse(localStorage.getItem("employment"))||"",f=JSON.parse(localStorage.getItem("position"))||"",h=JSON.parse(localStorage.getItem("postjob"))||"",I=JSON.parse(localStorage.getItem("salary"))||0,_=JSON.parse(localStorage.getItem("total-workers"))||0,N=JSON.parse(localStorage.getItem("total-salary"))||0;(()=>{for(let e=0;e<c.length;e++)c[e].addEventListener("change",(()=>{"radio"==c[e].type&&c[e].checked&&(b=c[e].value,localStorage.setItem("employment",JSON.stringify(b)))}))})(),(()=>{for(let e=0;e<a.length;e++)a[e].addEventListener("change",(()=>{"radio"==a[e].type&&a[e].checked&&(v=a[e].value,localStorage.setItem("gender",JSON.stringify(v)))}))})(),n.addEventListener("change",(()=>{let e=n.selectedIndex,t=n.options;switch(!0){case"fe"==n.value:f=`${t[e].textContent}`,f=w(f," "),I+=0,localStorage.setItem("salary",JSON.stringify(I)),localStorage.setItem("position",JSON.stringify(f));break;case"be"==n.value:f=`${t[e].textContent}`,f=w(f," "),I+=1e4,localStorage.setItem("salary",JSON.stringify(I)),localStorage.setItem("position",JSON.stringify(f));break;case"fs"==n.value:f=`${t[e].textContent}`,f=w(f," "),I+=3e4,localStorage.setItem("salary",JSON.stringify(I)),localStorage.setItem("position",JSON.stringify(f))}})),s.addEventListener("change",(()=>{let e=s.selectedIndex,t=s.options;switch(!0){case"tra"==s.value:case"jun"==s.value:case"mid"==s.value:case"sen"==s.value:h=`${t[e].textContent}`,h=w(h," "),localStorage.setItem("postjob",JSON.stringify(h))}}));const w=(e,t)=>e.replace(new RegExp(`${t}.*`),""),J=e=>(e.salary=e.salary+I-e.salary*(+b/100),e.salary),O=e=>"string"==typeof e&&isNaN(e)&&!(e.startsWith(" ")||e.endsWith(" ")),W=()=>{y.innerHTML=`${N} руб.`,g.innerHTML=`${_} чел.`},E=()=>{m.innerHTML="",Worker.workerArr.forEach(((e,t)=>{const r=document.createElement("tr");r.classList.add("table__items"),r.insertAdjacentHTML("beforeend",`\n\t\t\t\t<td class="table__item">${e.name}</td>\n\n\t\t\t\t<td class="table__item">${e.surname}</td>\n\n\t\t\t\t<td class="table__item">${e.age}</td>\n\n\t\t\t\t<td class="table__item">${e.gender}</td>\n\n\t\t\t\t<td class="table__item">${e.position}</td>\n\n\t\t\t\t<td class="table__item">${e.postJob}</td>\n\n\t\t\t\t<td class="table__item">${e._salary} руб.</td>\n\n\t\t\t\t<td class="table__item">\n\t\t\t\t\t<button type="button" class="table__button">Удалить</button>\n\t\t\t\t</td>\n\t\t\t`),m.append(r),r.querySelector(".table__button").addEventListener("click",(e=>{e.target.parentElement,Worker.removeWorker(t),q(),W(),E(),localStorage.setItem("total-workers",JSON.stringify(_)),localStorage.setItem("total-salary",JSON.stringify(N)),localStorage.setItem("workers",JSON.stringify(Worker.workerArr))}))}))},q=()=>{N=+Worker.workerArr.reduce(((e,t)=>e+ +t._salary),0),_=Worker.workerArr.length},L=()=>{e.value="",t.value="",r.value="",v="",b="",f="",h="",I=0,postjob.value="",n.value="",l.checked=!1,o.checked=!1,i.checked=!1,d.checked=!1};k.addEventListener("click",(()=>{S.classList.remove("show"),p.style.transform=""})),u.addEventListener("submit",(a=>{var n;a.preventDefault(),!O(e.value)||!O(t.value)||(n=r.value,isNaN(parseFloat(n))||!isFinite(n)||n.startsWith(" ")||n.endsWith(" "))||!l.checked&&!o.checked||!i.checked&&!d.checked?(S.classList.add("show"),p.style.transform="scale(1)"):((()=>{switch(!0){case"tra"==s.value:const a=new Trainee(e.value,t.value,r.value,v,h,f);"30"==b?J(a):a.salary=a.salary+I,a.addWorker(a);break;case"jun"==s.value:const l=new Junior(e.value,t.value,r.value,v,h,f);"30"==b?J(l):l.salary=l.salary+I,l.addWorker(l);break;case"mid"==s.value:const o=new Middle(e.value,t.value,r.value,v,h,f);"30"==b?J(o):o.salary=o.salary+I,o.addWorker(o);break;case"sen"==s.value:const n=new Senior(e.value,t.value,r.value,v,h,f);"30"==b?J(n):n.salary=n.salary+I,n.addWorker(n)}})(),E(),q(),W(),L(),localStorage.setItem("total-workers",JSON.stringify(_)),localStorage.setItem("total-salary",JSON.stringify(N)),localStorage.setItem("workers",JSON.stringify(Worker.workerArr)))})),E(),W()})()})();